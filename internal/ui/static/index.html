<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>状態遷移ビジュアライザー</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>状態遷移ビジュアライザー</h1>
        
        <div class="state-container">
            <div class="current-state">
                <h2>現在のPhase</h2>
                <div id="current-state" class="state-display">ready</div>
            </div>

            <!-- 階層構造表示エリアを追加 -->
            <div class="phase-hierarchy">
                <h2>Phase階層構造</h2>
                <div class="hierarchy-container">
                    <div id="parent-phase" class="hierarchy-item parent-phase">
                        <div class="phase-label">親Phase: <span id="parent-phase-name">-</span></div>
                        <div class="phase-state">状態: <span id="parent-phase-state">-</span></div>
                    </div>
                    <div id="current-phase" class="hierarchy-item current-phase">
                        <div class="phase-label">現在のPhase: <span id="current-phase-name">-</span></div>
                        <div class="phase-state">状態: <span id="current-phase-state">-</span></div>
                    </div>
                    <div id="child-phases" class="hierarchy-item child-phases">
                        <div class="phase-label">子Phase:</div>
                        <div id="child-phases-list" class="child-phases-list">
                            <!-- 子フェーズリストがここに動的に追加されます -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- すべてのPhase情報を表示するセクション -->
            <div class="all-phases-container">
                <h2>すべてのPhase</h2>
                <div id="all-phases-list" class="all-phases-list">
                    <!-- すべてのフェーズリストがここに動的に追加されます -->
                </div>
            </div>

            <div class="info-wrapper">
                <div class="phase-details">
                    <h2>Phase詳細</h2>
                    <div class="phase-info">
                        <div class="phase-info-item">
                            <span class="phase-info-label">名前:</span>
                            <span id="phase-name" class="phase-info-value">-</span>
                        </div>
                        <div class="phase-info-item">
                            <span class="phase-info-label">説明:</span>
                            <span id="phase-description" class="phase-info-value">-</span>
                        </div>
                        <div class="phase-info-item">
                            <span class="phase-info-label">順序:</span>
                            <span id="phase-order" class="phase-info-value">-</span>
                        </div>
                        <!-- 親IDを表示する項目を追加 -->
                        <div class="phase-info-item">
                            <span class="phase-info-label">親ID:</span>
                            <span id="phase-parent-id" class="phase-info-value">-</span>
                        </div>
                        <div class="phase-info-item">
                            <span class="phase-info-label">開始時間:</span>
                            <span id="phase-start-time" class="phase-info-value phase-time">-</span>
                        </div>
                        <div class="phase-info-item">
                            <span class="phase-info-label">終了時間:</span>
                            <span id="phase-finish-time" class="phase-info-value phase-time">-</span>
                        </div>
                    </div>
                </div>

                <div class="conditions-container">
                    <h2>条件の状態</h2>
                    <div id="conditions-list" class="conditions-list">
                        <!-- 条件リストがここに動的に追加されます -->
                    </div>
                </div>
            </div>

            <div class="state-diagram">
                <svg id="state-svg" viewBox="0 0 800 200">
                    <!-- 状態を表す円 -->
                    <g id="states">
                        <g class="state" data-state="ready">
                            <circle cx="100" cy="100" r="30" />
                            <text x="100" y="100">Ready</text>
                        </g>
                        <g class="state" data-state="active">
                            <circle cx="300" cy="100" r="30" />
                            <text x="300" y="100">Active</text>
                        </g>
                        <g class="state" data-state="next">
                            <circle cx="500" cy="100" r="30" />
                            <text x="500" y="100">Next</text>
                        </g>
                        <g class="state" data-state="finish">
                            <circle cx="700" cy="100" r="30" />
                            <text x="700" y="100">Finish</text>
                        </g>
                    </g>

                    <!-- 遷移を表す矢印 -->
                    <g id="transitions">
                        <g class="transition" data-event="activate">
                            <path d="M140,100 L260,100" />
                            <text x="200" y="80">activate</text>
                        </g>
                        <g class="transition" data-event="next">
                            <path d="M340,100 L460,100" />
                            <text x="400" y="80">next</text>
                        </g>
                        <g class="transition" data-event="finish">
                            <path d="M540,100 L660,100" />
                            <text x="600" y="80">finish</text>
                        </g>
                    </g>
                </svg>
            </div>

            <div class="controls">
                <button id="activate-btn" class="control-btn">Activate</button>
                <button id="next-btn" class="control-btn">Next</button>
                <button id="finish-btn" class="control-btn">Progress</button>
            </div>
        </div>

        <div class="status-container">
            <h2>ステータス</h2>
            <div id="status-message" class="status-message"></div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>